<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CPGIO Knowledge Base | Capabilities, KPIs & RFP Intelligence</title>

    <!-- React and ReactDOM via CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- SheetJS for Excel parsing -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>

    <!-- Styles -->
    <link rel="stylesheet" href="styles-modern.css">

    <!-- Preconnect for fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

</head>
<body>
    <div id="root"></div>

    <!-- Knowledge Base Data -->
    <script src="knowledge-base-data.js"></script>

    <!-- Main Application -->
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Icon helper function
        const Icon = ({ name, size = 20, strokeWidth = 2, ...props }) => {
            const iconMap = {
                'home': '<svg xmlns="http://www.w3.org/2000/svg" width="SIZE" height="SIZE" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="STROKE" stroke-linecap="round" stroke-linejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>',
                'zap': '<svg xmlns="http://www.w3.org/2000/svg" width="SIZE" height="SIZE" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="STROKE" stroke-linecap="round" stroke-linejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>',
                'bar-chart-3': '<svg xmlns="http://www.w3.org/2000/svg" width="SIZE" height="SIZE" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="STROKE" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3v18h18"/><path d="M18 17V9"/><path d="M13 17V5"/><path d="M8 17v-3"/></svg>',
                'trending-up': '<svg xmlns="http://www.w3.org/2000/svg" width="SIZE" height="SIZE" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="STROKE" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/><polyline points="16 7 22 7 22 13"/></svg>',
                'target': '<svg xmlns="http://www.w3.org/2000/svg" width="SIZE" height="SIZE" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="STROKE" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>',
                'sparkles': '<svg xmlns="http://www.w3.org/2000/svg" width="SIZE" height="SIZE" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="STROKE" stroke-linecap="round" stroke-linejoin="round"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M19 17v4"/><path d="M3 5h4"/><path d="M17 19h4"/></svg>',
                'file-text': '<svg xmlns="http://www.w3.org/2000/svg" width="SIZE" height="SIZE" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="STROKE" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" x2="8" y1="13" y2="13"/><line x1="16" x2="8" y1="17" y2="17"/><line x1="10" x2="8" y1="9" y2="9"/></svg>',
                'menu': '<svg xmlns="http://www.w3.org/2000/svg" width="SIZE" height="SIZE" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="STROKE" stroke-linecap="round" stroke-linejoin="round"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>',
                'moon': '<svg xmlns="http://www.w3.org/2000/svg" width="SIZE" height="SIZE" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="STROKE" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>',
                'sun': '<svg xmlns="http://www.w3.org/2000/svg" width="SIZE" height="SIZE" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="STROKE" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>',
                'upload': '<svg xmlns="http://www.w3.org/2000/svg" width="SIZE" height="SIZE" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="STROKE" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></svg>',
                'arrow-right': '<svg xmlns="http://www.w3.org/2000/svg" width="SIZE" height="SIZE" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="STROKE" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>',
                'search': '<svg xmlns="http://www.w3.org/2000/svg" width="SIZE" height="SIZE" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="STROKE" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>',
                'shield': '<svg xmlns="http://www.w3.org/2000/svg" width="SIZE" height="SIZE" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="STROKE" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>',
                'rocket': '<svg xmlns="http://www.w3.org/2000/svg" width="SIZE" height="SIZE" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="STROKE" stroke-linecap="round" stroke-linejoin="round"><path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"/><path d="m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"/><path d="M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"/><path d="M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"/></svg>',
                'users': '<svg xmlns="http://www.w3.org/2000/svg" width="SIZE" height="SIZE" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="STROKE" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>',
                'book': '<svg xmlns="http://www.w3.org/2000/svg" width="SIZE" height="SIZE" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="STROKE" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>',
                'chevron-down': '<svg xmlns="http://www.w3.org/2000/svg" width="SIZE" height="SIZE" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="STROKE" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>'
            };

            const svg = iconMap[name] || iconMap['home'];
            const finalSvg = svg.replace(/SIZE/g, size).replace(/STROKE/g, strokeWidth);
            return <span dangerouslySetInnerHTML={{ __html: finalSvg }} {...props} />;
        };

        // Main App Component
        function App() {
            const [activeSection, setActiveSection] = useState('home');
            const [searchQuery, setSearchQuery] = useState('');
            const [aiQuery, setAiQuery] = useState('');
            const [aiResponse, setAiResponse] = useState(null);
            const [aiLoading, setAiLoading] = useState(false);
            const [uploadedRFP, setUploadedRFP] = useState(null);
            const [sidebarOpen, setSidebarOpen] = useState(true);
            const [selectedCapability, setSelectedCapability] = useState(null);
            const [selectedCaseStudy, setSelectedCaseStudy] = useState(null);
            const [theme, setTheme] = useState(() => {
                return localStorage.getItem('theme') || 'light';
            });

            useEffect(() => {
                document.documentElement.setAttribute('data-theme', theme);
                localStorage.setItem('theme', theme);
            }, [theme]);

            const toggleTheme = () => {
                setTheme(prev => prev === 'light' ? 'dark' : 'light');
            };

            return (
                <div className="app-container">
                    <Sidebar
                        activeSection={activeSection}
                        setActiveSection={setActiveSection}
                        sidebarOpen={sidebarOpen}
                        setSidebarOpen={setSidebarOpen}
                    />

                    <main className={`main-content ${!sidebarOpen ? 'sidebar-collapsed' : ''}`}>
                        <Header
                            searchQuery={searchQuery}
                            setSearchQuery={setSearchQuery}
                            setSidebarOpen={setSidebarOpen}
                            sidebarOpen={sidebarOpen}
                        />

                        <div className="content-wrapper">
                            {activeSection === 'home' && <HomePage setActiveSection={setActiveSection} />}
                            {activeSection === 'capabilities' && (
                                <CapabilitiesPage
                                    selectedCapability={selectedCapability}
                                    setSelectedCapability={setSelectedCapability}
                                    searchQuery={searchQuery}
                                />
                            )}
                            {activeSection === 'case-studies' && (
                                <CaseStudiesPage
                                    selectedCaseStudy={selectedCaseStudy}
                                    setSelectedCaseStudy={setSelectedCaseStudy}
                                    searchQuery={searchQuery}
                                />
                            )}
                            {activeSection === 'kpis' && <KPIsPage searchQuery={searchQuery} />}
                            {activeSection === 'frameworks' && <FrameworksPage searchQuery={searchQuery} />}
                            {activeSection === 'about' && <AboutPage />}
                            {activeSection === 'glossary' && <GlossaryPage />}
                            {activeSection === 'rfp-center' && <RFPCenterPage />}
                            {activeSection === 'ai-qa' && (
                                <AIQAPage
                                    aiQuery={aiQuery}
                                    setAiQuery={setAiQuery}
                                    aiResponse={aiResponse}
                                    setAiResponse={setAiResponse}
                                    aiLoading={aiLoading}
                                    setAiLoading={setAiLoading}
                                />
                            )}
                            {activeSection === 'rfp-analyzer' && (
                                <RFPAnalyzerPage
                                    uploadedRFP={uploadedRFP}
                                    setUploadedRFP={setUploadedRFP}
                                />
                            )}
                        </div>
                    </main>

                    <button
                        className="theme-toggle"
                        onClick={toggleTheme}
                        aria-label="Toggle theme"
                    >
                        <Icon name={theme === 'light' ? 'moon' : 'sun'} size={24} />
                    </button>
                </div>
            );
        }

        // Sidebar Component
        function Sidebar({ activeSection, setActiveSection, sidebarOpen, setSidebarOpen }) {
            const navItems = [
                { id: 'home', label: 'Home', icon: 'home' },
                { id: 'capabilities', label: 'Capabilities', icon: 'zap' },
                { id: 'rfp-center', label: 'RFP Center', icon: 'file-text' },
                { id: 'case-studies', label: 'Case Studies', icon: 'bar-chart-3' },
                { id: 'kpis', label: 'Service KPIs', icon: 'trending-up' },
                { id: 'frameworks', label: 'Frameworks', icon: 'target' },
                { id: 'about', label: 'Team', icon: 'users' },
                { id: 'glossary', label: 'Glossary', icon: 'book' },
                { id: 'ai-qa', label: 'AI Q&A', icon: 'sparkles', badge: 'BETA' },
                { id: 'rfp-analyzer', label: 'RFP Analyzer', icon: 'upload', badge: 'BETA' },
            ];

            return (
                <aside className={`sidebar ${!sidebarOpen ? 'collapsed' : ''}`}>
                    {sidebarOpen && (
                        <div className="sidebar-header">
                            <div className="logo">
                                <span className="logo-icon">CPGIO</span>
                                <span className="logo-text">Knowledge Base</span>
                            </div>
                        </div>
                    )}

                    <nav className="sidebar-nav">
                        <button
                            className="nav-item sidebar-toggle-btn"
                            onClick={() => setSidebarOpen(!sidebarOpen)}
                            title={sidebarOpen ? "Collapse sidebar" : "Expand sidebar"}
                        >
                            <span className="nav-icon"><Icon name="menu" size={20} /></span>
                            {sidebarOpen && <span className="nav-label">Collapse</span>}
                        </button>

                        {navItems.map(item => (
                            <button
                                key={item.id}
                                className={`nav-item ${activeSection === item.id ? 'active' : ''}`}
                                onClick={() => setActiveSection(item.id)}
                                title={!sidebarOpen ? item.label : ''}
                            >
                                <span className="nav-icon"><Icon name={item.icon} size={20} /></span>
                                {sidebarOpen && (
                                    <span className="nav-label">
                                        {item.label}
                                        {item.badge && <span className="badge-beta">{item.badge}</span>}
                                    </span>
                                )}
                            </button>
                        ))}
                    </nav>

                    {sidebarOpen && (
                        <div className="sidebar-footer">
                            <button className="cta-button" onClick={() => window.location.href = 'mailto:sales@cpgio.com?subject=Requesting%20CPGIO%20Audit'}>
                                Start Your Audit
                            </button>
                            <div className="contact-info">
                                <p className="contact-label">Contact</p>
                                <p className="contact-detail">sales@cpgio.com</p>
                                <p className="contact-detail">(866) 764-4605 ext 712</p>
                                <a href="https://cpg.io" target="_blank" className="contact-link">cpg.io</a>
                            </div>
                        </div>
                    )}
                </aside>
            );
        }

        // Header Component
        function Header({ searchQuery, setSearchQuery, setSidebarOpen, sidebarOpen }) {
            const [showResults, setShowResults] = useState(false);
            const searchRef = useRef(null);

            // Close dropdown when clicking outside
            useEffect(() => {
                const handleClickOutside = (event) => {
                    if (searchRef.current && !searchRef.current.contains(event.target)) {
                        setShowResults(false);
                    }
                };
                document.addEventListener('mousedown', handleClickOutside);
                return () => document.removeEventListener('mousedown', handleClickOutside);
            }, []);

            // Search across all content types
            const getSearchResults = () => {
                if (!searchQuery || searchQuery.length < 2) return null;

                const query = searchQuery.toLowerCase();
                const results = {
                    capabilities: [],
                    caseStudies: [],
                    kpis: [],
                    glossary: []
                };

                // Search capabilities
                results.capabilities = knowledgeBase.capabilities.filter(cap =>
                    cap.title.toLowerCase().includes(query) ||
                    cap.description.toLowerCase().includes(query) ||
                    cap.category.toLowerCase().includes(query)
                ).slice(0, 3);

                // Search case studies
                results.caseStudies = knowledgeBase.caseStudies.filter(cs =>
                    cs.title.toLowerCase().includes(query) ||
                    cs.category.toLowerCase().includes(query) ||
                    cs.brand.toLowerCase().includes(query) ||
                    cs.challenge.toLowerCase().includes(query)
                ).slice(0, 3);

                // Search KPIs
                const kpiCategories = Object.keys(knowledgeBase.serviceKPIs);
                kpiCategories.forEach(category => {
                    const kpis = knowledgeBase.serviceKPIs[category];
                    Object.keys(kpis).forEach(key => {
                        const kpi = kpis[key];
                        if (key.toLowerCase().includes(query) ||
                            kpi.value.toLowerCase().includes(query)) {
                            results.kpis.push({ category, key, ...kpi });
                        }
                    });
                });
                results.kpis = results.kpis.slice(0, 3);

                // Search Glossary
                results.glossary = knowledgeBase.glossary.filter(item =>
                    item.term.toLowerCase().includes(query) ||
                    item.definition.toLowerCase().includes(query) ||
                    item.category.toLowerCase().includes(query)
                ).slice(0, 3);

                return results;
            };

            const searchResults = getSearchResults();
            const hasResults = searchResults && (
                searchResults.capabilities.length > 0 ||
                searchResults.caseStudies.length > 0 ||
                searchResults.kpis.length > 0 ||
                searchResults.glossary.length > 0
            );

            return (
                <header className="header">
                    <div className="header-left">
                        <button
                            className="sidebar-toggle"
                            onClick={() => setSidebarOpen(!sidebarOpen)}
                            aria-label="Toggle sidebar"
                        >
                            <Icon name="menu" size={24} />
                        </button>
                    </div>

                    <div className="header-search" ref={searchRef}>
                        <input
                            type="text"
                            placeholder="Search capabilities, case studies, KPIs..."
                            value={searchQuery}
                            onChange={(e) => {
                                setSearchQuery(e.target.value);
                                setShowResults(true);
                            }}
                            onFocus={() => setShowResults(true)}
                            className="search-input"
                        />

                        {showResults && hasResults && (
                            <div className="search-results-dropdown">
                                {searchResults.capabilities.length > 0 && (
                                    <div className="search-category">
                                        <div className="search-category-title">Capabilities</div>
                                        {searchResults.capabilities.map(cap => (
                                            <div key={cap.id} className="search-result-item">
                                                <strong>{cap.title}</strong>
                                                <span className="search-result-meta">{cap.category}</span>
                                            </div>
                                        ))}
                                    </div>
                                )}

                                {searchResults.caseStudies.length > 0 && (
                                    <div className="search-category">
                                        <div className="search-category-title">Case Studies</div>
                                        {searchResults.caseStudies.map(cs => (
                                            <div key={cs.id} className="search-result-item">
                                                <strong>{cs.brand}</strong>
                                                <span className="search-result-meta">{cs.category}</span>
                                            </div>
                                        ))}
                                    </div>
                                )}

                                {searchResults.kpis.length > 0 && (
                                    <div className="search-category">
                                        <div className="search-category-title">KPIs</div>
                                        {searchResults.kpis.map((kpi, idx) => (
                                            <div key={idx} className="search-result-item">
                                                <strong>{kpi.key}</strong>
                                                <span className="search-result-meta">{kpi.value}</span>
                                            </div>
                                        ))}
                                    </div>
                                )}

                                {searchResults.glossary.length > 0 && (
                                    <div className="search-category">
                                        <div className="search-category-title">Glossary</div>
                                        {searchResults.glossary.map((item, idx) => (
                                            <div key={idx} className="search-result-item">
                                                <strong>{item.term}</strong>
                                                <span className="search-result-meta">{item.category}</span>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>
                        )}
                    </div>
                </header>
            );
        }

        // Home Page Component
        function HomePage({ setActiveSection }) {
            return (
                <div className="page-content">
                    <div className="hero-section">
                        <h1 className="page-title">CPGIO Knowledge Base</h1>
                        <p className="page-subtitle">
                            Explore our capabilities, proven results, and service-level KPIs.
                            Use AI-powered Q&A for brand discovery or analyze RFPs with intelligent automation.
                        </p>
                    </div>

                    <div className="card-grid">
                        <div className="feature-card" onClick={() => setActiveSection('capabilities')}>
                            <div className="card-icon"><Icon name="zap" size={32} /></div>
                            <h3 className="card-title">Capabilities</h3>
                            <p className="card-description">
                                12 core capabilities spanning integrated operations, financial flexibility,
                                ASIN prioritization, fulfillment excellence, and more.
                            </p>
                            <div className="card-stats">
                                <span className="stat-badge">12 Capabilities</span>
                                <span className="stat-badge">60+ KPIs</span>
                            </div>
                        </div>

                        <div className="feature-card" onClick={() => setActiveSection('case-studies')}>
                            <div className="card-icon"><Icon name="bar-chart-3" size={32} /></div>
                            <h3 className="card-title">Case Studies</h3>
                            <p className="card-description">
                                Real client success stories with quantified results across fulfillment,
                                growth, media, and brand protection.
                            </p>
                            <div className="card-stats">
                                <span className="stat-badge">20+ Case Studies</span>
                                <span className="stat-badge">8 Categories</span>
                            </div>
                        </div>

                        <div className="feature-card" onClick={() => setActiveSection('kpis')}>
                            <div className="card-icon"><Icon name="trending-up" size={32} /></div>
                            <h3 className="card-title">Service KPIs</h3>
                            <p className="card-description">
                                Performance metrics and benchmarks across fulfillment, media,
                                growth, compliance, and omnichannel execution.
                            </p>
                            <div className="card-stats">
                                <span className="stat-badge">6 Categories</span>
                                <span className="stat-badge">Verified Data</span>
                            </div>
                        </div>

                        <div className="feature-card highlight" onClick={() => setActiveSection('ai-qa')}>
                            <div className="card-icon"><Icon name="sparkles" size={32} /></div>
                            <h3 className="card-title">AI Q&A</h3>
                            <p className="card-description">
                                Ask questions about CPGIO's capabilities, approach, and services.
                                Get instant, context-aware answers from our knowledge base.
                            </p>
                            <div className="card-badge">Try it now</div>
                        </div>

                        <div className="feature-card highlight" onClick={() => setActiveSection('rfp-analyzer')}>
                            <div className="card-icon"><Icon name="file-text" size={32} /></div>
                            <h3 className="card-title">RFP Analyzer</h3>
                            <p className="card-description">
                                Upload Excel RFPs for intelligent analysis. Automatically extract questions
                                and format for streamlined response creation.
                            </p>
                            <div className="card-badge">Upload RFP</div>
                        </div>

                        <div className="feature-card" onClick={() => setActiveSection('frameworks')}>
                            <div className="card-icon"><Icon name="target" size={32} /></div>
                            <h3 className="card-title">Frameworks</h3>
                            <p className="card-description">
                                Strategic frameworks including Financial Models, Go-To-Market Approach,
                                and ASIN Scorecard System.
                            </p>
                            <div className="card-stats">
                                <span className="stat-badge">2 Frameworks</span>
                            </div>
                        </div>
                    </div>

                    <div className="process-timeline">
                        <h2 className="section-title">Our Engagement Process</h2>
                        <div className="timeline-container">
                            {knowledgeBase.process.map((step, index) => (
                                <div key={step.step} className="timeline-step">
                                    <div className="timeline-icon">
                                        <Icon name={step.icon} size={32} />
                                    </div>
                                    <div className="timeline-content">
                                        <div className="timeline-number">Step {step.step}</div>
                                        <h3 className="timeline-title">{step.title}</h3>
                                        <p className="timeline-description">{step.description}</p>
                                    </div>
                                    {index < knowledgeBase.process.length - 1 && (
                                        <div className="timeline-connector"></div>
                                    )}
                                </div>
                            ))}
                        </div>
                    </div>

                    <div className="quick-stats">
                        <h2 className="section-title">Performance Highlights</h2>
                        <div className="stats-grid">
                            <div className="stat-item">
                                <div className="stat-value">48K units/hr</div>
                                <div className="stat-label">Peak Velocity</div>
                            </div>
                            <div className="stat-item">
                                <div className="stat-value">5-8x</div>
                                <div className="stat-label">ROAS Range</div>
                            </div>
                            <div className="stat-item">
                                <div className="stat-value">$526K</div>
                                <div className="stat-label">Monthly Revenue Recovery</div>
                            </div>
                            <div className="stat-item">
                                <div className="stat-value">800+</div>
                                <div className="stat-label">ASINs Launched</div>
                            </div>
                            <div className="stat-item">
                                <div className="stat-value">56</div>
                                <div className="stat-label">Sellers Removed</div>
                            </div>
                            <div className="stat-item">
                                <div className="stat-value">&lt;0.01%</div>
                                <div className="stat-label">Defect Rate</div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Capabilities Page Component
        function CapabilitiesPage({ selectedCapability, setSelectedCapability, searchQuery }) {
            const filteredCapabilities = knowledgeBase.capabilities.filter(cap =>
                cap.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
                cap.description.toLowerCase().includes(searchQuery.toLowerCase()) ||
                cap.category.toLowerCase().includes(searchQuery.toLowerCase())
            );

            if (selectedCapability) {
                const capability = knowledgeBase.capabilities.find(c => c.id === selectedCapability);
                return <CapabilityDetail capability={capability} onBack={() => setSelectedCapability(null)} />;
            }

            const categories = [...new Set(knowledgeBase.capabilities.map(c => c.category))];

            return (
                <div className="page-content">
                    <div className="page-header">
                        <h1 className="page-title">CPGIO Capabilities</h1>
                        <p className="page-subtitle">
                            Comprehensive overview of CPGIO's operational capabilities, strategic frameworks,
                            and service-level performance metrics.
                        </p>
                    </div>

                    {categories.map(category => {
                        const capsInCategory = filteredCapabilities.filter(c => c.category === category);
                        if (capsInCategory.length === 0) return null;

                        return (
                            <div key={category} className="capability-category">
                                <h2 className="category-title">{category}</h2>
                                <div className="capability-list">
                                    {capsInCategory.map(cap => (
                                        <div
                                            key={cap.id}
                                            className="capability-card"
                                            onClick={() => setSelectedCapability(cap.id)}
                                        >
                                            <h3 className="capability-title">{cap.title}</h3>
                                            <p className="capability-description">{cap.description}</p>

                                            <div className="kpi-preview">
                                                {cap.kpis.slice(0, 3).map((kpi, idx) => (
                                                    <div key={idx} className="kpi-badge">
                                                        <span className="kpi-metric">{kpi.metric}:</span>
                                                        <span className="kpi-value">{kpi.value}</span>
                                                    </div>
                                                ))}
                                            </div>

                                            <div className="card-footer">
                                                <span className="view-details">View details →</span>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        );
                    })}
                </div>
            );
        }

        // Capability Detail Component
        function CapabilityDetail({ capability, onBack }) {
            return (
                <div className="page-content">
                    <button className="back-button" onClick={onBack}>
                        ← Back to Capabilities
                    </button>

                    <div className="detail-header">
                        <div className="category-badge">{capability.category}</div>
                        <h1 className="detail-title">{capability.title}</h1>
                        <p className="detail-description">{capability.description}</p>
                    </div>

                    <div className="detail-section">
                        <h2 className="section-title">Key Points</h2>
                        <ul className="key-points-list">
                            {capability.keyPoints.map((point, idx) => (
                                <li key={idx} className="key-point">{point}</li>
                            ))}
                        </ul>
                    </div>

                    <div className="detail-section">
                        <h2 className="section-title">Service-Level KPIs</h2>
                        <div className="kpi-grid">
                            {capability.kpis.map((kpi, idx) => (
                                <div key={idx} className="kpi-card">
                                    <div className="kpi-card-value">{kpi.value}</div>
                                    <div className="kpi-card-metric">{kpi.metric}</div>
                                    <div className="kpi-card-description">{kpi.description}</div>
                                </div>
                            ))}
                        </div>
                    </div>

                    {capability.relatedCaseStudies && capability.relatedCaseStudies.length > 0 && (
                        <div className="detail-section">
                            <h2 className="section-title">Related Case Studies</h2>
                            <div className="related-cases">
                                {capability.relatedCaseStudies.map(caseId => {
                                    const caseStudy = knowledgeBase.caseStudies.find(c => c.id === caseId);
                                    if (!caseStudy) return null;
                                    return (
                                        <div key={caseId} className="mini-case-card">
                                            <h4 className="mini-case-title">{caseStudy.title}</h4>
                                            <p className="mini-case-category">{caseStudy.category}</p>
                                        </div>
                                    );
                                })}
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        // Case Studies Page Component
        function CaseStudiesPage({ selectedCaseStudy, setSelectedCaseStudy, searchQuery }) {
            const [expandedCase, setExpandedCase] = useState(null);

            const filteredCaseStudies = knowledgeBase.caseStudies.filter(cs =>
                cs.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
                cs.category.toLowerCase().includes(searchQuery.toLowerCase()) ||
                cs.challenge.toLowerCase().includes(searchQuery.toLowerCase())
            );

            if (selectedCaseStudy) {
                const caseStudy = knowledgeBase.caseStudies.find(c => c.id === selectedCaseStudy);
                return <CaseStudyDetail caseStudy={caseStudy} onBack={() => setSelectedCaseStudy(null)} />;
            }

            const categories = [...new Set(knowledgeBase.caseStudies.map(c => c.category))];

            const toggleCase = (caseId) => {
                setExpandedCase(expandedCase === caseId ? null : caseId);
            };

            return (
                <div className="page-content">
                    <div className="page-header">
                        <h1 className="page-title">Client Success Stories</h1>
                        <p className="page-subtitle">
                            Real-world results across fulfillment, growth, media optimization,
                            brand protection, and omnichannel expansion.
                        </p>
                    </div>

                    {categories.map(category => {
                        const casesInCategory = filteredCaseStudies.filter(c => c.category === category);
                        if (casesInCategory.length === 0) return null;

                        return (
                            <div key={category} className="case-study-category">
                                <h2 className="category-title">{category}</h2>
                                <div className="accordion-container">
                                    {casesInCategory.map(cs => {
                                        const isExpanded = expandedCase === cs.id;
                                        return (
                                            <div key={cs.id} className="accordion-item">
                                                <button
                                                    className="accordion-trigger"
                                                    onClick={() => toggleCase(cs.id)}
                                                >
                                                    <div className="accordion-header-content">
                                                        <div>
                                                            <h3 className="accordion-title">{cs.brand}</h3>
                                                            <p className="accordion-subtitle">{cs.title}</p>
                                                        </div>
                                                        <div className="accordion-stats">
                                                            {Object.entries(cs.results).slice(0, 2).map(([key, value], idx) => (
                                                                <span key={idx} className="stat-pill">{value}</span>
                                                            ))}
                                                        </div>
                                                    </div>
                                                    <span className={`accordion-chevron ${isExpanded ? 'expanded' : ''}`}>
                                                        <Icon name="chevron-down" size={20} />
                                                    </span>
                                                </button>

                                                {isExpanded && (
                                                    <div className="accordion-content">
                                                        <div className="accordion-section">
                                                            <h4 className="accordion-section-title">Challenge</h4>
                                                            <p className="accordion-text">{cs.challenge}</p>
                                                        </div>

                                                        <div className="accordion-section">
                                                            <h4 className="accordion-section-title">Execution</h4>
                                                            <ul className="accordion-list">
                                                                {cs.execution.map((item, idx) => (
                                                                    <li key={idx}>{item}</li>
                                                                ))}
                                                            </ul>
                                                        </div>

                                                        <div className="accordion-section">
                                                            <h4 className="accordion-section-title">Results</h4>
                                                            <div className="results-grid-compact">
                                                                {Object.entries(cs.results).map(([key, value]) => (
                                                                    <div key={key} className="result-item-compact">
                                                                        <div className="result-value-compact">{value}</div>
                                                                        <div className="result-label-compact">
                                                                            {key.replace(/([A-Z])/g, ' $1').trim()}
                                                                        </div>
                                                                    </div>
                                                                ))}
                                                            </div>
                                                        </div>
                                                    </div>
                                                )}
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>
                        );
                    })}
                </div>
            );
        }

        // Case Study Detail Component
        function CaseStudyDetail({ caseStudy, onBack }) {
            return (
                <div className="page-content">
                    <button className="back-button" onClick={onBack}>
                        ← Back to Case Studies
                    </button>

                    <div className="detail-header">
                        <div className="category-badge">{caseStudy.category}</div>
                        <h1 className="detail-title">{caseStudy.title}</h1>
                        <p className="detail-brand">{caseStudy.brand}</p>
                        {caseStudy.portfolio && <p className="detail-portfolio">{caseStudy.portfolio}</p>}
                    </div>

                    <div className="detail-section">
                        <h2 className="section-title">Challenge</h2>
                        <p className="challenge-text">{caseStudy.challenge}</p>
                    </div>

                    <div className="detail-section">
                        <h2 className="section-title">Execution</h2>
                        <ul className="execution-list">
                            {caseStudy.execution.map((item, idx) => (
                                <li key={idx} className="execution-item">{item}</li>
                            ))}
                        </ul>
                    </div>

                    <div className="detail-section">
                        <h2 className="section-title">Results</h2>
                        <div className="results-grid">
                            {Object.entries(caseStudy.results).map(([key, value]) => (
                                <div key={key} className="result-card">
                                    <div className="result-value-large">{value}</div>
                                    <div className="result-label">{key.replace(/([A-Z])/g, ' $1').trim()}</div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        }

        // KPIs Page Component
        function KPIsPage({ searchQuery }) {
            return (
                <div className="page-content">
                    <div className="page-header">
                        <h1 className="page-title">Service-Level KPIs</h1>
                        <p className="page-subtitle">
                            Performance benchmarks and metrics across all service categories,
                            backed by real client results.
                        </p>
                    </div>

                    {Object.entries(knowledgeBase.serviceKPIs).map(([category, kpis]) => (
                        <div key={category} className="kpi-category">
                            <h2 className="category-title">{category.charAt(0).toUpperCase() + category.slice(1)}</h2>
                            <div className="kpi-grid-large">
                                {Object.entries(kpis).map(([key, kpi]) => (
                                    <div key={key} className="kpi-card-large">
                                        <div className="kpi-value-large">{kpi.value}</div>
                                        <div className="kpi-metric-large">
                                            {key.replace(/([A-Z])/g, ' $1').trim()}
                                        </div>
                                        {kpi.detail && <div className="kpi-detail">{kpi.detail}</div>}
                                        {kpi.condition && <div className="kpi-condition">{kpi.condition}</div>}
                                        {kpi.timeline && <div className="kpi-timeline">Timeline: {kpi.timeline}</div>}
                                        {kpi.source && (
                                            <div className="kpi-source">
                                                Source: {typeof kpi.source === 'string' ? kpi.source : kpi.sources?.join(', ')}
                                            </div>
                                        )}
                                    </div>
                                ))}
                            </div>
                        </div>
                    ))}
                </div>
            );
        }

        // AI Q&A Page Component (to be continued...)
        function AIQAPage({ aiQuery, setAiQuery, aiResponse, setAiResponse, aiLoading, setAiLoading }) {
            const suggestedQuestions = [
                "What is your defect rate?",
                "How do you handle returns?",
                "What ROAS do you typically achieve?",
                "How fast can you ship 100K units?",
                "How do you protect brands from unauthorized sellers?",
                "What is the difference between 3PL and Distribution models?",
                "Can you help with Amazon Brand Registry?",
                "What is your experience with FBA and FBM?"
            ];

            const handleAskQuestion = () => {
                if (!aiQuery.trim()) return;

                setAiLoading(true);

                // Simulate AI processing with knowledge base search
                setTimeout(() => {
                    const response = searchKnowledgeBase(aiQuery);
                    setAiResponse(response);
                    setAiLoading(false);
                }, 1500);
            };

            const handleSuggestedClick = (question) => {
                setAiQuery(question);
                // Auto-submit the question
                setTimeout(() => {
                    setAiLoading(true);
                    setTimeout(() => {
                        const response = searchKnowledgeBase(question);
                        setAiResponse(response);
                        setAiLoading(false);
                    }, 1500);
                }, 100);
            };

            const searchKnowledgeBase = (query) => {
                const lowerQuery = query.toLowerCase();
                let relevantContent = {
                    capabilities: [],
                    caseStudies: [],
                    kpis: [],
                    answer: ''
                };

                // Search capabilities
                knowledgeBase.capabilities.forEach(cap => {
                    const score = calculateRelevance(lowerQuery, cap);
                    if (score > 0) {
                        relevantContent.capabilities.push({ ...cap, score });
                    }
                });

                // Search case studies
                knowledgeBase.caseStudies.forEach(cs => {
                    const score = calculateRelevance(lowerQuery, cs);
                    if (score > 0) {
                        relevantContent.caseStudies.push({ ...cs, score });
                    }
                });

                // Sort by relevance
                relevantContent.capabilities.sort((a, b) => b.score - a.score);
                relevantContent.caseStudies.sort((a, b) => b.score - a.score);

                // Generate answer
                relevantContent.answer = generateAnswer(lowerQuery, relevantContent);

                return relevantContent;
            };

            const calculateRelevance = (query, item) => {
                let score = 0;
                const searchText = JSON.stringify(item).toLowerCase();

                // Keyword matching
                const keywords = query.split(' ').filter(w => w.length > 3);
                keywords.forEach(keyword => {
                    if (searchText.includes(keyword)) {
                        score += 10;
                    }
                });

                return score;
            };

            const generateAnswer = (query, content) => {
                // Simple answer generation based on query patterns
                if (query.includes('media') || query.includes('advertising') || query.includes('roas')) {
                    return `CPGIO's media framework achieves 5-8x ROAS through data-driven strategies. We target new-to-brand shoppers and optimize campaigns using Amazon Marketing Cloud (AMC) and Pacvue. Notable results include SOLA (7-8x ROAS, $20K → $800K/month) and Bob's Red Mill (5.53x ROAS with 29% new-to-brand orders).`;
                } else if (query.includes('fulfillment') || query.includes('warehouse') || query.includes('shipping')) {
                    return `CPGIO offers high-volume fulfillment with peak velocity of 48,000 units/hour and surge capacity of 200,000 units/month. We maintain <0.01% defect rates even at peak volume, supporting FBA, FBM, and hybrid 3P/1P operations with co-packing and kitting capabilities.`;
                } else if (query.includes('brand protection') || query.includes('unauthorized') || query.includes('sellers')) {
                    return `CPGIO's brand protection strategy has removed 56 unauthorized sellers in a single campaign, recovering $526K in monthly revenue and 28,608 units. We use Amazon Transparency, IP enforcement, MAP-aligned pricing, and systematic seller containment with <24 hour response time to new violations.`;
                } else if (query.includes('3pl') || query.includes('distribution') || query.includes('model')) {
                    return `CPGIO offers both 3PL (performance-based service) and Distribution (vendor-of-record) models using the same operational engine. The choice depends on brand maturity and control preferences, not capability. 3PL offers transparent billing and strategic control, while Distribution provides maximum speed and risk transfer.`;
                } else if (query.includes('growth') || query.includes('scale') || query.includes('revenue')) {
                    return `CPGIO delivers proven growth results: SOLA scaled from $20K to $800K/month in 18 months, an $8B consumer goods company reached $1M/month, and BFY snack portfolio grew 267% ($71K → $261K monthly). Our data-driven ASIN prioritization and integrated operations drive sustainable scaling.`;
                } else {
                    return `Based on your question, I found ${content.capabilities.length} relevant capabilities and ${content.caseStudies.length} case studies. CPGIO's systems-first approach integrates forecasting, fulfillment, content, media, and customer operations into a unified engine. Key strengths include 5-8x ROAS, 48K units/hour fulfillment velocity, and proven brand protection.`;
                }
            };

            return (
                <div className="page-content">
                    <div className="page-header">
                        <h1 className="page-title">AI-Powered Q&A</h1>
                        <p className="page-subtitle">
                            Ask questions about CPGIO's capabilities, performance, and approach.
                            Get intelligent answers drawn from our complete knowledge base.
                        </p>
                    </div>

                    <div className="ai-qa-container">
                        <div className="qa-input-section">
                            <textarea
                                className="qa-textarea"
                                placeholder="Ask anything about CPGIO's capabilities, services, performance, case studies, or approach..."
                                value={aiQuery}
                                onChange={(e) => setAiQuery(e.target.value)}
                                rows="4"
                            />
                            <button
                                className="qa-submit-button"
                                onClick={handleAskQuestion}
                                disabled={aiLoading || !aiQuery.trim()}
                            >
                                {aiLoading ? 'Searching knowledge base...' : 'Ask Question'}
                            </button>
                        </div>

                        {!aiResponse && (
                            <div className="suggested-questions">
                                <h3 className="suggested-title">Suggested Questions</h3>
                                <div className="question-chips">
                                    {suggestedQuestions.map((question, idx) => (
                                        <button
                                            key={idx}
                                            className="question-chip"
                                            onClick={() => handleSuggestedClick(question)}
                                            disabled={aiLoading}
                                        >
                                            {question}
                                        </button>
                                    ))}
                                </div>
                            </div>
                        )}

                        {aiResponse && (
                            <div className="qa-response-section">
                                <div className="qa-answer">
                                    <h3 className="qa-section-title">Answer</h3>
                                    <p className="qa-answer-text">{aiResponse.answer}</p>
                                </div>

                                {aiResponse.capabilities.length > 0 && (
                                    <div className="qa-references">
                                        <h3 className="qa-section-title">Related Capabilities</h3>
                                        <div className="qa-ref-list">
                                            {aiResponse.capabilities.slice(0, 3).map(cap => (
                                                <div key={cap.id} className="qa-ref-card">
                                                    <h4 className="qa-ref-title">{cap.title}</h4>
                                                    <p className="qa-ref-description">{cap.description}</p>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                {aiResponse.caseStudies.length > 0 && (
                                    <div className="qa-references">
                                        <h3 className="qa-section-title">Related Case Studies</h3>
                                        <div className="qa-ref-list">
                                            {aiResponse.caseStudies.slice(0, 3).map(cs => (
                                                <div key={cs.id} className="qa-ref-card">
                                                    <h4 className="qa-ref-title">{cs.title}</h4>
                                                    <p className="qa-ref-brand">{cs.brand}</p>
                                                    <p className="qa-ref-description">{cs.challenge}</p>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}

                        <div className="qa-suggestions">
                            <h3 className="qa-section-title">Suggested Questions</h3>
                            <div className="suggestion-chips">
                                <button className="suggestion-chip" onClick={() => setAiQuery("What is CPGIO's media performance?")}>
                                    What is CPGIO's media performance?
                                </button>
                                <button className="suggestion-chip" onClick={() => setAiQuery("How does brand protection work?")}>
                                    How does brand protection work?
                                </button>
                                <button className="suggestion-chip" onClick={() => setAiQuery("What are your fulfillment capabilities?")}>
                                    What are your fulfillment capabilities?
                                </button>
                                <button className="suggestion-chip" onClick={() => setAiQuery("Explain the 3PL vs Distribution model")}>
                                    Explain 3PL vs Distribution
                                </button>
                                <button className="suggestion-chip" onClick={() => setAiQuery("Show me growth case studies")}>
                                    Show me growth case studies
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // RFP Analyzer Page Component
        function RFPAnalyzerPage({ uploadedRFP, setUploadedRFP }) {
            const fileInputRef = useRef(null);

            const handleFileUpload = (event) => {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const data = new Uint8Array(e.target.result);
                        const workbook = XLSX.read(data, { type: 'array' });

                        // Parse the workbook
                        const parsedData = parseRFPWorkbook(workbook);
                        setUploadedRFP({
                            fileName: file.name,
                            data: parsedData,
                            uploadDate: new Date()
                        });
                    } catch (error) {
                        console.error('Error parsing Excel file:', error);
                        alert('Error parsing Excel file. Please ensure it\'s a valid RFP format.');
                    }
                };
                reader.readAsArrayBuffer(file);
            };

            const parseRFPWorkbook = (workbook) => {
                const questions = [];
                const seenQuestions = new Set(); // Avoid duplicates

                // Iterate through sheets
                workbook.SheetNames.forEach(sheetName => {
                    const sheet = workbook.Sheets[sheetName];
                    const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });

                    // Try to detect header rows and question columns
                    const detectedFormat = detectRFPFormat(jsonData);

                    // Look for question patterns
                    jsonData.forEach((row, rowIndex) => {
                        // Skip likely header rows
                        if (rowIndex === 0 && isLikelyHeaderRow(row)) return;

                        row.forEach((cell, colIndex) => {
                            if (cell && typeof cell === 'string') {
                                const trimmedCell = cell.trim();

                                // Skip very short cells or obvious non-questions
                                if (trimmedCell.length < 10) return;
                                if (isLikelyNonQuestion(trimmedCell)) return;

                                // Enhanced question detection
                                const isQuestion = detectIfQuestion(trimmedCell);

                                if (isQuestion && !seenQuestions.has(trimmedCell)) {
                                    seenQuestions.add(trimmedCell);
                                    questions.push({
                                        id: `q-${questions.length + 1}`,
                                        sheet: sheetName,
                                        row: rowIndex + 1,
                                        col: colIndex + 1,
                                        question: trimmedCell,
                                        category: categorizeQuestion(trimmedCell),
                                        suggestedResponse: generateSuggestedResponse(trimmedCell),
                                        response: ''
                                    });
                                }
                            }
                        });
                    });
                });

                return { questions };
            };

            // Detect if a row is likely a header row
            const isLikelyHeaderRow = (row) => {
                if (!row || row.length === 0) return false;
                const headerKeywords = ['question', 'requirement', 'response', 'vendor', 'answer', 'description', 'section', 'category', 'item', '#'];
                const rowText = row.join(' ').toLowerCase();
                return headerKeywords.some(keyword => rowText.includes(keyword)) && row.join('').length < 100;
            };

            // Detect if text is likely not a question
            const isLikelyNonQuestion = (text) => {
                const lower = text.toLowerCase();
                // Skip navigation, labels, or instructions
                if (lower.match(/^(section|part|page|tab|sheet|column|row)\s*\d/)) return true;
                if (lower.match(/^(note|instruction|example|total|subtotal|yes|no)s?[:]/)) return true;
                // Skip dates and numbers
                if (lower.match(/^\d{1,2}\/\d{1,2}\/\d{2,4}$/)) return true;
                if (lower.match(/^[\d,.$]+$/)) return true;
                return false;
            };

            // Enhanced question detection using multiple patterns
            const detectIfQuestion = (text) => {
                const lower = text.toLowerCase();

                // Question mark detection
                if (text.includes('?')) return true;

                // Imperative verbs commonly used in RFPs
                const imperativeVerbs = [
                    'describe', 'explain', 'provide', 'list', 'detail', 'outline',
                    'identify', 'specify', 'indicate', 'state', 'demonstrate',
                    'confirm', 'verify', 'submit', 'include', 'attach', 'present',
                    'discuss', 'address', 'define', 'clarify', 'elaborate'
                ];

                // Interrogative words
                const interrogatives = [
                    'how', 'what', 'when', 'where', 'why', 'which', 'who',
                    'does', 'do', 'can', 'will', 'would', 'could', 'should',
                    'is', 'are', 'have', 'has'
                ];

                // Check for imperative verbs at start of sentence
                const words = lower.split(/\s+/);
                if (words.length > 3 && imperativeVerbs.some(verb => words[0] === verb)) {
                    return true;
                }

                // Check for interrogatives at start
                if (interrogatives.some(word => words[0] === word)) {
                    return true;
                }

                // Check for "please" followed by imperative
                if (lower.startsWith('please') && imperativeVerbs.some(verb => lower.includes(verb))) {
                    return true;
                }

                // RFP-specific patterns
                if (lower.match(/^(vendor|bidder|proposer|contractor|supplier)\s+(must|shall|should|will)/)) {
                    return true;
                }

                // Requirement patterns
                if (lower.match(/(requirement|mandatory|required|must|shall).*[:]/)) {
                    return true;
                }

                return false;
            };

            // Detect RFP format structure
            const detectRFPFormat = (jsonData) => {
                // This could be expanded to detect:
                // - Column-based format (questions in one column, responses in another)
                // - Row-based format (question per row)
                // - Hierarchical format (sections with sub-questions)
                // - Table format with merged cells

                // For now, return basic detection
                return {
                    type: 'standard',
                    hasHeaders: jsonData.length > 0 && isLikelyHeaderRow(jsonData[0])
                };
            };

            const categorizeQuestion = (question) => {
                const lowerQ = question.toLowerCase();

                // Pricing & Financial
                const pricingKeywords = ['price', 'pricing', 'fee', 'cost', 'rate', 'budget', 'payment', 'invoice', 'billing', 'charge', 'financial', 'revenue share', 'commission'];
                if (pricingKeywords.some(kw => lowerQ.includes(kw))) return 'Pricing';

                // Media & Advertising
                const mediaKeywords = ['media', 'advertising', 'marketing', 'roas', 'acos', 'tacos', 'ppc', 'campaign', 'ad spend', 'amazon advertising', 'sponsored', 'dsp'];
                if (mediaKeywords.some(kw => lowerQ.includes(kw))) return 'Media';

                // Fulfillment & Logistics
                const fulfillmentKeywords = ['fulfillment', 'warehouse', 'warehousing', 'shipping', 'logistics', 'fba', 'fbm', '3pl', 'inventory', 'storage', 'distribution', 'receiving', 'picking', 'packing', 'kitting', 'co-pack'];
                if (fulfillmentKeywords.some(kw => lowerQ.includes(kw))) return 'Fulfillment';

                // Brand Protection
                const brandProtectionKeywords = ['brand protection', 'unauthorized', 'map pricing', 'counterfeit', 'ip enforcement', 'trademark', 'seller removal', 'transparency', 'gray market'];
                if (brandProtectionKeywords.some(kw => lowerQ.includes(kw))) return 'Brand Protection';

                // Technology & Systems
                const technologyKeywords = ['technology', 'tech stack', 'system', 'platform', 'software', 'integration', 'api', 'automation', 'tool', 'dashboard', 'reporting', 'analytics', 'data'];
                if (technologyKeywords.some(kw => lowerQ.includes(kw))) return 'Technology';

                // Customer Service & Support
                const supportKeywords = ['customer service', 'customer support', 'response time', 'support hours', 'helpdesk', 'ticket', 'escalation', 'sla'];
                if (supportKeywords.some(kw => lowerQ.includes(kw))) return 'Customer Support';

                // Compliance & Certifications
                const complianceKeywords = ['compliance', 'certification', 'iso', 'soc', 'audit', 'regulation', 'gdpr', 'ccpa', 'privacy', 'security', 'insurance'];
                if (complianceKeywords.some(kw => lowerQ.includes(kw))) return 'Compliance';

                // Case Studies & References
                const caseStudyKeywords = ['case study', 'case studies', 'example', 'reference', 'client', 'portfolio', 'previous work', 'past experience'];
                if (caseStudyKeywords.some(kw => lowerQ.includes(kw))) return 'Case Studies';

                // Company Overview & Experience
                const companyKeywords = ['company', 'organization', 'experience', 'background', 'history', 'founded', 'team', 'staff', 'employee', 'year', 'about'];
                if (companyKeywords.some(kw => lowerQ.includes(kw))) return 'Company Overview';

                // Product & Catalog Management
                const productKeywords = ['product', 'catalog', 'asin', 'sku', 'listing', 'content', 'image', 'photography', 'a+ content', 'enhanced brand content'];
                if (productKeywords.some(kw => lowerQ.includes(kw))) return 'Product Management';

                // Growth & Strategy
                const growthKeywords = ['growth', 'strategy', 'expansion', 'scaling', 'international', 'marketplace', 'channel', 'sales'];
                if (growthKeywords.some(kw => lowerQ.includes(kw))) return 'Growth Strategy';

                // Omnichannel & Retail
                const omnichannelKeywords = ['omnichannel', 'retail', 'walmart', 'target', 'costco', 'brick and mortar', 'b2b', 'wholesale'];
                if (omnichannelKeywords.some(kw => lowerQ.includes(kw))) return 'Omnichannel';

                return 'General';
            };

            const generateSuggestedResponse = (question) => {
                const category = categorizeQuestion(question);
                const suggestions = {
                    'Pricing': 'Reference: Financial Models Framework - 3PL vs Distribution comparison',
                    'Media': 'Reference: Media Framework + Case Studies (SOLA 7-8x ROAS, Bob\'s Red Mill 5.53x ROAS)',
                    'Fulfillment': 'Reference: Fulfillment Excellence capability (48K units/hr, <0.01% defect) + Influencer Spice case study',
                    'Brand Protection': 'Reference: Brand Protection capability (56 sellers removed, $526K recovery) + Mason Jar case study',
                    'Technology': 'Reference: HyperQue system + Integrated Operations capability + Forecasting accuracy',
                    'Customer Support': 'Reference: Customer Operations capability + Response times + Support structure',
                    'Compliance': 'Reference: Compliance & certifications section + Security protocols + Insurance coverage',
                    'Case Studies': 'Reference: Browse Case Studies section - 20+ examples across 8 categories',
                    'Company Overview': 'Reference: About CPGIO + Core Philosophy + Team structure + Years in business',
                    'Product Management': 'Reference: ASIN Prioritization + Content Optimization + 800+ ASINs launched',
                    'Growth Strategy': 'Reference: Portfolio Growth case studies (267% growth examples) + Go-To-Market approach',
                    'Omnichannel': 'Reference: Omnichannel Orchestration capability + Retail expansion case studies',
                    'General': 'Search knowledge base for relevant content across all capabilities'
                };
                return suggestions[category] || suggestions['General'];
            };

            const downloadFormattedRFP = () => {
                if (!uploadedRFP) return;

                // Create new workbook with formatted responses
                const wb = XLSX.utils.book_new();

                // Create responses sheet
                const responsesData = [
                    ['Question #', 'Sheet', 'Row', 'Question', 'Category', 'CPGIO Response', 'Suggested Reference']
                ];

                uploadedRFP.data.questions.forEach((q, idx) => {
                    responsesData.push([
                        idx + 1,
                        q.sheet,
                        q.row,
                        q.question,
                        q.category,
                        q.response || '[Add your response here]',
                        q.suggestedResponse
                    ]);
                });

                const ws = XLSX.utils.aoa_to_sheet(responsesData);
                XLSX.utils.book_append_sheet(wb, ws, 'CPGIO Responses');

                // Download
                XLSX.writeFile(wb, `CPGIO_RFP_Response_${new Date().toISOString().split('T')[0]}.xlsx`);
            };

            const updateResponse = (questionId, newResponse) => {
                setUploadedRFP(prev => ({
                    ...prev,
                    data: {
                        ...prev.data,
                        questions: prev.data.questions.map(q =>
                            q.id === questionId ? { ...q, response: newResponse } : q
                        )
                    }
                }));
            };

            return (
                <div className="page-content">
                    <div className="page-header">
                        <h1 className="page-title">RFP Analyzer</h1>
                        <p className="page-subtitle">
                            Upload Excel RFPs for intelligent analysis. Automatically extract questions,
                            categorize them, and get suggested knowledge base references for streamlined responses.
                        </p>
                    </div>

                    {!uploadedRFP ? (
                        <div className="upload-section">
                            <div className="upload-box" onClick={() => fileInputRef.current?.click()}>
                                <div className="upload-icon"><Icon name="upload" size={80} strokeWidth={1.5} /></div>
                                <h3 className="upload-title">Upload RFP Excel File</h3>
                                <p className="upload-description">
                                    Click to browse or drag and drop your RFP file here
                                </p>
                                <p className="upload-formats">Supports .xlsx, .xls</p>
                            </div>
                            <input
                                ref={fileInputRef}
                                type="file"
                                accept=".xlsx,.xls"
                                onChange={handleFileUpload}
                                style={{ display: 'none' }}
                            />

                            <div className="feature-list">
                                <h3 className="section-title">What This Tool Does</h3>
                                <ul className="features">
                                    <li>✓ Automatically extracts questions from Excel RFPs</li>
                                    <li>✓ Categorizes questions (Pricing, Media, Fulfillment, etc.)</li>
                                    <li>✓ Suggests relevant knowledge base references</li>
                                    <li>✓ Provides formatted response template</li>
                                    <li>✓ Exports completed responses back to Excel</li>
                                </ul>
                            </div>
                        </div>
                    ) : (
                        <div className="rfp-analysis">
                            <div className="rfp-header">
                                <div className="rfp-info">
                                    <h3 className="rfp-filename">{uploadedRFP.fileName}</h3>
                                    <p className="rfp-stats">
                                        {uploadedRFP.data.questions.length} questions detected
                                    </p>
                                </div>
                                <div className="rfp-actions">
                                    <button className="secondary-button" onClick={() => setUploadedRFP(null)}>
                                        Upload New RFP
                                    </button>
                                    <button className="primary-button" onClick={downloadFormattedRFP}>
                                        Download Response Template
                                    </button>
                                </div>
                            </div>

                            <div className="questions-list">
                                {uploadedRFP.data.questions.map((q, idx) => (
                                    <div key={q.id} className="question-card">
                                        <div className="question-header">
                                            <div className="question-number">Q{idx + 1}</div>
                                            <div className="question-category-badge">{q.category}</div>
                                            <div className="question-location">
                                                Sheet: {q.sheet} | Row: {q.row}
                                            </div>
                                        </div>
                                        <div className="question-text">{q.question}</div>
                                        <div className="question-suggestion">
                                            <strong>💡 Suggested Reference:</strong> {q.suggestedResponse}
                                        </div>
                                        <textarea
                                            className="response-textarea"
                                            placeholder="Type your response here..."
                                            value={q.response}
                                            onChange={(e) => updateResponse(q.id, e.target.value)}
                                            rows="3"
                                        />
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        // About/Team Page Component
        function AboutPage() {
            return (
                <div className="page-content">
                    <div className="page-header">
                        <h1 className="page-title">Our Team</h1>
                        <p className="page-subtitle">
                            Meet the experts behind CPGIO's proven track record of eCommerce excellence.
                        </p>
                    </div>

                    <div className="team-grid">
                        {knowledgeBase.team.map((member, index) => (
                            <div key={index} className="team-card">
                                <div className="team-photo">
                                    <img src={member.photoUrl} alt={member.name} />
                                </div>
                                <div className="team-info">
                                    <h3 className="team-name">{member.name}</h3>
                                    <p className="team-role">{member.role}</p>
                                    <p className="team-bio">{member.bio}</p>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        // Glossary Page Component
        function GlossaryPage() {
            const [glossarySearch, setGlossarySearch] = useState('');
            const [selectedLetter, setSelectedLetter] = useState('ALL');

            const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');

            // Filter glossary by search and letter
            const filteredGlossary = knowledgeBase.glossary.filter(item => {
                const matchesSearch = !glossarySearch ||
                    item.term.toLowerCase().includes(glossarySearch.toLowerCase()) ||
                    item.definition.toLowerCase().includes(glossarySearch.toLowerCase()) ||
                    item.category.toLowerCase().includes(glossarySearch.toLowerCase());

                const matchesLetter = selectedLetter === 'ALL' ||
                    item.term.toUpperCase().startsWith(selectedLetter);

                return matchesSearch && matchesLetter;
            });

            // Group by category
            const categories = [...new Set(knowledgeBase.glossary.map(item => item.category))];

            return (
                <div className="page-content">
                    <div className="page-header">
                        <h1 className="page-title">eCommerce Glossary</h1>
                        <p className="page-subtitle">
                            Essential terms and concepts in Amazon marketplace operations, logistics, and digital commerce.
                        </p>
                    </div>

                    {/* Search Bar */}
                    <div className="glossary-search">
                        <input
                            type="text"
                            placeholder="Search terms, definitions, categories..."
                            value={glossarySearch}
                            onChange={(e) => setGlossarySearch(e.target.value)}
                            className="search-input"
                        />
                    </div>

                    {/* A-Z Index */}
                    <div className="az-index">
                        <button
                            className={`az-letter ${selectedLetter === 'ALL' ? 'active' : ''}`}
                            onClick={() => setSelectedLetter('ALL')}
                        >
                            ALL
                        </button>
                        {alphabet.map(letter => (
                            <button
                                key={letter}
                                className={`az-letter ${selectedLetter === letter ? 'active' : ''}`}
                                onClick={() => setSelectedLetter(letter)}
                            >
                                {letter}
                            </button>
                        ))}
                    </div>

                    {/* Glossary Terms */}
                    <div className="glossary-grid">
                        {filteredGlossary.map((item, index) => (
                            <div key={index} className="glossary-card">
                                <div className="glossary-header">
                                    <h3 className="glossary-term">{item.term}</h3>
                                    <span className="glossary-category">{item.category}</span>
                                </div>
                                <p className="glossary-definition">{item.definition}</p>
                                {item.cpgioContext && (
                                    <div className="glossary-context">
                                        <strong>Why it matters to CPGIO:</strong>
                                        <p>{item.cpgioContext}</p>
                                    </div>
                                )}
                            </div>
                        ))}
                    </div>

                    {filteredGlossary.length === 0 && (
                        <div className="no-results">
                            <p>No terms found matching your search.</p>
                        </div>
                    )}
                </div>
            );
        }

        // RFP Center Page Component
        function RFPCenterPage() {
            const [expandedQuestion, setExpandedQuestion] = useState(null);
            const [searchTerm, setSearchTerm] = useState('');
            const [copiedIndex, setCopiedIndex] = useState(null);

            const filteredQuestions = knowledgeBase.rfpAnswers.filter(item =>
                item.question.toLowerCase().includes(searchTerm.toLowerCase()) ||
                item.answer.toLowerCase().includes(searchTerm.toLowerCase()) ||
                item.tags.some(tag => tag.toLowerCase().includes(searchTerm.toLowerCase()))
            );

            const toggleQuestion = (index) => {
                setExpandedQuestion(expandedQuestion === index ? null : index);
            };

            const copyToClipboard = (text, index) => {
                navigator.clipboard.writeText(text);
                setCopiedIndex(index);
                setTimeout(() => setCopiedIndex(null), 2000);
            };

            return (
                <div className="page-content">
                    <div className="page-header">
                        <h1 className="page-title">RFP Center</h1>
                        <p className="page-subtitle">
                            Quick answers to common RFP questions. All responses include quantified results and can be copied directly into your proposals.
                        </p>
                    </div>

                    <div className="rfp-search">
                        <input
                            type="text"
                            placeholder="Search questions by topic, keyword, or tag..."
                            value={searchTerm}
                            onChange={(e) => setSearchTerm(e.target.value)}
                            className="search-input"
                        />
                    </div>

                    <div className="rfp-stats">
                        <div className="rfp-stat">
                            <span className="rfp-stat-value">{filteredQuestions.length}</span>
                            <span className="rfp-stat-label">Questions</span>
                        </div>
                        <div className="rfp-stat">
                            <span className="rfp-stat-value">{knowledgeBase.capabilities.length}</span>
                            <span className="rfp-stat-label">Capabilities</span>
                        </div>
                        <div className="rfp-stat">
                            <span className="rfp-stat-value">{knowledgeBase.caseStudies.length}</span>
                            <span className="rfp-stat-label">Case Studies</span>
                        </div>
                    </div>

                    <div className="accordion-container">
                        {filteredQuestions.map((item, index) => {
                            const isExpanded = expandedQuestion === index;
                            const relatedCapability = knowledgeBase.capabilities.find(
                                cap => cap.id === item.relatedCapabilityId
                            );

                            return (
                                <div key={index} className="accordion-item rfp-question-item">
                                    <button
                                        className="accordion-trigger"
                                        onClick={() => toggleQuestion(index)}
                                    >
                                        <div className="accordion-header-content">
                                            <h3 className="rfp-question-title">{item.question}</h3>
                                            <div className="rfp-tags">
                                                {item.tags.slice(0, 3).map((tag, idx) => (
                                                    <span key={idx} className="tag-pill">{tag}</span>
                                                ))}
                                            </div>
                                        </div>
                                        <span className={`accordion-chevron ${isExpanded ? 'expanded' : ''}`}>
                                            <Icon name="chevron-down" size={20} />
                                        </span>
                                    </button>

                                    {isExpanded && (
                                        <div className="accordion-content">
                                            <div className="rfp-answer-box">
                                                <div className="rfp-answer-header">
                                                    <h4>Copy-Paste Answer</h4>
                                                    <button
                                                        className="copy-button"
                                                        onClick={() => copyToClipboard(item.answer, index)}
                                                    >
                                                        {copiedIndex === index ? '✓ Copied!' : 'Copy'}
                                                    </button>
                                                </div>
                                                <p className="rfp-answer-text">{item.answer}</p>
                                            </div>

                                            {relatedCapability && (
                                                <div className="rfp-related">
                                                    <strong>Related Capability:</strong>
                                                    <a href="#" className="rfp-link">
                                                        {relatedCapability.title}
                                                    </a>
                                                </div>
                                            )}
                                        </div>
                                    )}
                                </div>
                            );
                        })}
                    </div>

                    {filteredQuestions.length === 0 && (
                        <div className="no-results">
                            <p>No questions found matching "{searchTerm}"</p>
                        </div>
                    )}
                </div>
            );
        }

        // Frameworks Page Component
        function FrameworksPage({ searchQuery }) {
            const [activeModel, setActiveModel] = useState('3pl');
            return (
                <div className="page-content">
                    <div className="page-header">
                        <h1 className="page-title">Strategic Frameworks</h1>
                        <p className="page-subtitle">
                            Core methodologies and approaches that guide CPGIO's operations and strategy.
                        </p>
                    </div>

                    <div className="framework-section">
                        <h2 className="framework-title">{knowledgeBase.frameworks.financialModels.title}</h2>
                        <div className="framework-philosophy">
                            <em>"{knowledgeBase.frameworks.financialModels.philosophy}"</em>
                        </div>
                        <p className="framework-description">{knowledgeBase.frameworks.financialModels.description}</p>

                        <div className="model-toggle">
                            <button
                                className={`toggle-btn ${activeModel === '3pl' ? 'active' : ''}`}
                                onClick={() => setActiveModel('3pl')}
                            >
                                3PL Model
                            </button>
                            <button
                                className={`toggle-btn ${activeModel === 'distribution' ? 'active' : ''}`}
                                onClick={() => setActiveModel('distribution')}
                            >
                                Distribution Model
                            </button>
                        </div>

                        <div className="models-comparison">
                            {knowledgeBase.frameworks.financialModels.models
                                .filter((model, idx) =>
                                    (activeModel === '3pl' && idx === 0) ||
                                    (activeModel === 'distribution' && idx === 1)
                                )
                                .map((model, idx) => (
                                    <div key={idx} className="model-card active-model">
                                        <h3 className="model-name">{model.name}</h3>
                                        <p className="model-description">{model.description}</p>
                                        <div className="benefits-header">Benefits:</div>
                                        <ul className="model-benefits">
                                            {model.benefits.map((benefit, bidx) => (
                                                <li key={bidx}>{benefit}</li>
                                            ))}
                                        </ul>
                                    </div>
                                ))}
                        </div>

                        <div className="framework-insight">
                            <strong>Key Insight:</strong> {knowledgeBase.frameworks.financialModels.keyInsight}
                        </div>
                    </div>

                    <div className="framework-section">
                        <h2 className="framework-title">{knowledgeBase.frameworks.gtmApproach.title}</h2>
                        <p className="framework-description">{knowledgeBase.frameworks.gtmApproach.description}</p>

                        {knowledgeBase.frameworks.gtmApproach.components.map((component, idx) => (
                            <div key={idx} className="framework-component">
                                <h3 className="component-name">{component.name}</h3>
                                <ul className="component-list">
                                    {(component.criteria || component.steps || component.approach || component.methods).map((item, iidx) => (
                                        <li key={iidx}>{item}</li>
                                    ))}
                                </ul>
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        // Render the app
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
